<%# app/views/meal_plans/create_or_update.turbo_stream.erb %>
<%= turbo_stream.replace "meal-plans-table" do %>
  <%= render partial: "meal_plans_table", locals: { 
    days: @days, 
    meal_types: @meal_types,
    meals_by_type: @meals_by_type,
    meal_plans: current_user.meal_plans
      .where(date: @start_date..@end_date)
      .joins(:meal)
      .select('meal_plans.*, meals.meal_type as meal_meal_type')
      .group_by { |mp| [mp.date, mp.meal_meal_type] }
  } %>
<% end %>